# UI rules: themes, layout, scaling

Этот документ фиксирует правила отображения интерфейса для `frontend` (React/Vite). Цель — единообразное поведение при разных размерах окна браузера, масштабе (zoom) и при переключении светлой/тёмной схемы.

## 1) Цветовые схемы (light/dark)

### 1.1. Источник темы

Поддерживаются 3 режима:

- `system` — тема следует `prefers-color-scheme`.
- `light` — принудительно светлая.
- `dark` — принудительно тёмная.

Хранение выбора:

- В `localStorage` ключ `ui.theme` со значением `system|light|dark`.
- По умолчанию — `system`.

### 1.2. Токены (семантические, без хардкода цветов)

Цвета в компонентах НЕ задаются значениями вроде `#fff`/`rgb(...)`. Вместо этого используются семантические токены (CSS variables или эквивалент в дизайн-системе):

- `--color-bg` — фон приложения
- `--color-fg` — основной текст
- `--color-muted` — вторичный текст
- `--color-border` — границы/разделители
- `--color-surface` — «карточки»/панели
- `--color-surface-2` — вложенные поверхности
- `--color-accent` — акцентные элементы (ссылки/основные кнопки)
- `--color-accent-contrast` — контент на акценте
- `--color-danger` / `--color-warning` / `--color-success` — статусы
- `--color-focus-ring` — фокус/доступность

Реальные значения токенов определяются темой (light/dark) централизованно. Компоненты используют только токены.

### 1.3. Контраст и состояния

- Текст/иконки должны быть читаемы на `--color-bg` и `--color-surface`.
- Состояния (hover/active/disabled) задаются через те же токены/примитивы темы (без отдельных «самодельных» цветов).
- Фокус обязателен для клавиатурной навигации: видимый `focus-ring` на интерактивных элементах.

## 2) Базовый layout (десктоп)

Приложение мыслится как «рабочая область», где есть центральный контент и вспомогательные панели.

Рекомендуемая сетка:

- **Центр**: основной контент (документ/версия/шаблон/превью).
- **Правая панель “Свойства”**: поля/параметры выбранного объекта (шаблонные поля, метаданные документа, параметры генерации).

Ключевое правило: панель “Свойства” никогда не должна «съедать» центральный контент до неюзабельного состояния.

## 3) Правила масштабирования и единицы измерения

### 3.1. Единицы

- Основная типографика и отступы — в `rem` (или дизайн-токенах), чтобы корректно реагировать на настройки браузера.
- Допускаются `px` только для тонких границ/разделителей.

### 3.2. Поддерживаемый zoom

UI должен оставаться работоспособным при zoom примерно в диапазоне 80%–200%:

- Не должно появляться «невидимых» кнопок/контролов.
- Важные действия доступны без горизонтального скролла на типовых экранах.

### 3.3. Минимальные размеры интерактивных зон

- Кликабельная зона (кнопки, пункты меню, иконки) — не меньше ~40px по одной из сторон или эквивалент в `rem`.

## 4) Панель “Свойства” и внутренние окна

### 4.1. Панель “Свойства” (dock справа)

Правила ширины:

- Ширина панели задаётся как адаптивная: `clamp(min, preferred, max)`.
- `min`: панель должна вмещать лейблы/инпуты без поломки верстки.
- `max`: панель не должна занимать больше разумной доли ширины окна.

Правила высоты:

- Панель по высоте равна рабочей области.
- Внутри панели допустим собственный вертикальный скролл.

### 4.2. Поведение на узких экранах

При недостатке ширины (условный «mobile/tablet» режим):

- Панель “Свойства” превращается в drawer/overlay и открывается по запросу.
- Центральный контент остаётся главным; overlay закрываемый.

### 4.3. Внутренние окна (вложенные панели/диалоги свойств)

Если внутри панели “Свойства” есть вложенные окна (например, выбор организации, справочник, редактор поля):

- В пределах панели: использовать вложенную поверхность `--color-surface-2` и внутренний скролл.
- Если окно требует полного внимания (подтверждение/критические действия): использовать модальное окно, ограниченное viewport.

Ограничения:

- Внутренние окна не должны выходить за границы viewport.
- Для модалок/оверлеев обязательны: trap focus, закрытие по Esc (если допускается), и видимый заголовок.

## 5) Переполнение текста и таблиц

- Длинные идентификаторы/пути/UUID: перенос или обрезка с `…`.
- Таблицы/списки в правой панели: при узкой ширине допускается вертикальная компоновка (label сверху, value ниже).

## 6) Что считается нарушением

- Любые захардкоженные цвета/тени/шрифты в компонентах.
- Панель “Свойства”, которая ломает основной контент на стандартном десктопном разрешении.
- Нерабочий UI при увеличении/уменьшении zoom.

## 7) Минимальная проверка перед мерджем

- Проверить `light`/`dark`/`system` на одной и той же странице.
- Проверить ширины: ~320px, ~768px, ~1024px, ~1440px.
- Проверить zoom 80% и 200%.
